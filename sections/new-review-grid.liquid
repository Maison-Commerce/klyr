<style>
  .js-show-more-reviews {
    cursor: pointer;
  }
  .review-col {
    transition: all 0.3s ease;
  }
  .js-show-more-reviews svg {
    transition: transform 0.3s ease;
  }
  .js-show-more-reviews.expanded svg {
    transform: rotate(180deg);
  }
</style>

<div class="review-area-wrapper inner-spacer">
  <div class="container-max">
    <div class="review-top-content">
      <h2 class="secondary-heading">{{ section.settings.heading }}</h2>
      <div class="overall-review">
        <ul class="review-retting">
          <li>{{ section.settings.average_rating }}</li><li>/</li><li>5</li>
        </ul>
        <ul class="review-starts">
          {% for i in (1..section.settings.full_stared_rating) %}
            <li>
              <svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 0.5L9.79611 6.02786H15.6085L10.9062 9.44427L12.7023 14.9721L8 11.5557L3.29772 14.9721L5.09383 9.44427L0.391548 6.02786H6.20389L8 0.5Z" fill="#231C19"/>
              </svg>
            </li>
          {% endfor %}
          {% for i in (1..section.settings.half_started_rating) %}
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="15" viewBox="0 0 16 15" fill="none">
                <g clip-path="url(#clip0_243_2930)">
                  <path d="M8 1L9.79611 6.52786H15.6085L10.9062 9.94427L12.7023 15.4721L8 12.0557L3.29772 15.4721L5.09383 9.94427L0.391548 6.52786H6.20389L8 1Z" fill="#231C19"/>
                </g>
                <path opacity="0.25" d="M8 1L9.79611 6.52786H15.6085L10.9062 9.94427L12.7023 15.4721L8 12.0557L3.29772 15.4721L5.09383 9.94427L0.391548 6.52786H6.20389L8 1Z" fill="#231C19"/>
                <defs>
                  <clipPath id="clip0_243_2930">
                    <rect width="8" height="15" fill="white"/>
                  </clipPath>
                </defs>
              </svg>
            </li>
          {% endfor %}
          {% assign empty_star = 5 | minus: section.settings.full_stared_rating | minus: section.settings.half_started_rating %}
          {% for i in (1..empty_star) %}
            <li>
              <svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path opacity="0.25" d="M8 0L9.79611 5.52786H15.6085L10.9062 8.94427L12.7023 14.4721L8 11.0557L3.29772 14.4721L5.09383 8.94427L0.391548 5.52786H6.20389L8 0Z" fill="#231C19"/>
              </svg>
            </li>
          {% endfor %}
        </ul>
      </div>
      <div class="total-review">
        <p>{{ section.settings.review_count_text }}</p>
      </div>
    </div>

    <div class="customer-review-wrapper">
      <div class="row g-xl-5 review-blocks-wrapper">
        {% for block in section.blocks %}
          <div class="col-12 col-lg-6 review-col" {{ block.shopify_attributes }}>
            <div class="costo-review-col">
              <div class="custo-single-review">
                <div class="custo-review-top">
                  <div class="custo-review-top-left">
                    <div class="casto-name">
                      <h4 class="font-base">{{ block.settings.reviewer_name }}</h4>
                    </div>
                    <div class="custo-type">
                      <p>{{ block.settings.buyer_type }}</p>
                      {% if block.settings.show_verified_icon %}
                        <svg width="12" height="13" viewBox="0 0 12 13" fill="none">
                          <circle cx="5.5" cy="6" r="5.5" fill="#231C19"/>
                          <line x1="3.2322" y1="5.76194" x2="4.69886" y2="7.22861" stroke="white" stroke-width="0.5"/>
                          <line x1="8.12136" y1="4.16018" x2="4.69913" y2="7.5824" stroke="white" stroke-width="0.5"/>
                        </svg>
                      {% endif %}
                    </div>
                  </div>
                  <div class="custo-review-top-right">
                    <ul class="review-retting">
                      <li>{{ block.settings.rating }}</li><li>/</li><li>5</li>
                    </ul>
                    <ul class="review-starts">
                      {% for i in (1..block.settings.rating) %}
                        <li>
                          <svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 0.5L9.79611 6.02786H15.6085L10.9062 9.44427L12.7023 14.9721L8 11.5557L3.29772 14.9721L5.09383 9.44427L0.391548 6.02786H6.20389L8 0.5Z" fill="#231C19"/>
                          </svg>
                        </li>
                      {% endfor %}
                      {% assign empty_star = 5 | minus: block.settings.rating %}
                      {% for i in (1..empty_star) %}
                        <li>
                          <svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path opacity="0.25" d="M8 0L9.79611 5.52786H15.6085L10.9062 8.94427L12.7023 14.4721L8 11.0557L3.29772 14.4721L5.09383 8.94427L0.391548 5.52786H6.20389L8 0Z" fill="#231C19"/>
                          </svg>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                </div>
                <div class="custo-review-main-cont">
                  <div class="left-cont">
                    <h4 class="font-base">{{ block.settings.review_title }}</h4>
                    <p>{{ block.settings.review_text }}</p>
                  </div>
                  {% if block.settings.profile_image != blank %}
                    <div class="custo-profile">
                      <img src="{{ block.settings.profile_image | image_url }}" alt="{{ block.settings.reviewer_name }}" width="auto" height="auto">
                    </div>
                  {% endif %}
                </div>
                <div class="custo-review-bottom">
                  <div class="review-tatal-reaction">
                    <span>
                      <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_243_1347)">
                          <path opacity="0.5" d="M2.61037 4.50714H1.03766C0.894011 4.5075 0.756365 4.56482 0.654927 4.66654C0.553489 4.76826 0.496542 4.90606 0.496582 5.04971V10.1603C0.496542 10.3039 0.553489 10.4417 0.654927 10.5434C0.756365 10.6451 0.894011 10.7025 1.03766 10.7028H2.61037C2.75417 10.7025 2.89199 10.6452 2.99367 10.5436C3.09536 10.4419 3.15262 10.3041 3.15293 10.1603V5.04971C3.15262 4.90591 3.09536 4.76809 2.99367 4.66641C2.89199 4.56472 2.75417 4.50746 2.61037 4.50714ZM10.2702 6.28647C10.2702 6.04123 10.1729 5.80602 9.99969 5.63241C9.98494 5.61641 9.96904 5.6015 9.95212 5.58782C10.1439 5.50653 10.3018 5.36148 10.399 5.17719C10.4962 4.99291 10.5267 4.78072 10.4855 4.57651C10.4442 4.3723 10.3337 4.18861 10.1725 4.05652C10.0114 3.92442 9.80965 3.85204 9.60131 3.8516H6.37564C6.39347 3.82039 6.40983 3.79214 6.42469 3.7639C6.51751 3.61405 6.59141 3.45328 6.64469 3.28525C6.7158 3.05233 6.75921 2.81185 6.77401 2.56877C6.7946 2.21757 6.74471 1.8658 6.62728 1.53418C6.50985 1.20256 6.32725 0.897794 6.09023 0.63782C6.00094 0.536394 5.89214 0.453983 5.77033 0.3955C5.64851 0.337017 5.51616 0.303659 5.38118 0.297414C5.19678 0.290334 5.01652 0.353178 4.87649 0.47336C4.73646 0.593541 4.64701 0.762187 4.62604 0.945522C4.62481 0.952387 4.62431 0.959363 4.62456 0.966333V2.2685L3.76239 4.45363C3.69179 4.63134 3.58555 4.79272 3.45023 4.92782V9.96404C3.66305 10.0226 3.87958 10.0668 4.09834 10.0963C4.17964 10.1072 4.26158 10.1127 4.34361 10.1127H8.71537C8.93143 10.1124 9.13866 10.0269 9.29212 9.87485C9.36765 9.79931 9.42753 9.70961 9.46834 9.6109C9.50915 9.51219 9.53009 9.40639 9.52996 9.29958C9.53048 9.10244 9.45853 8.91199 9.3278 8.76444C9.49998 8.72825 9.65844 8.64415 9.78492 8.52184C9.9114 8.39952 10.0008 8.24397 10.0427 8.07309C10.0846 7.90222 10.0775 7.72297 10.022 7.55599C9.96652 7.38902 9.86501 7.24111 9.72915 7.12931C9.89049 7.05526 10.0272 6.9365 10.1231 6.78712C10.219 6.63773 10.2701 6.46399 10.2702 6.28647Z" fill="#231C19"/>
                        </g>
                        <defs>
                          <clipPath id="clip0_243_1347">
                          <rect width="11" height="11" fill="white"/>
                          </clipPath>
                        </defs>
                      </svg>
                    </span>
                    <span>{{ block.settings.reaction_count }}</span>
                  </div>
                  <div class="review-days-count">
                    <p>{{ block.settings.review_date }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      {% if section.blocks.size > 6 %}
        <div class="show-more-review-btn">
          <button type="button" class="btn-borderd js-show-more-reviews">
            <span>{{ section.settings.show_more_label }}</span>
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M10.728 7.224L5.97605 12L1.20005 7.224L1.20005 5.64L5.42405 9.96L5.42405 -2.34992e-07L6.57605 -1.84637e-07L6.57605 9.96L10.8 5.64L10.8 7.224L10.728 7.224Z" fill="#231C19"/>
							</svg>
          </button>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const reviewBlocks = document.querySelectorAll(".review-blocks-wrapper > .review-col");
    const toggleButton = document.querySelector(".js-show-more-reviews");
    let expanded = false;

    // Function to get default visible count based on screen size
    function getDefaultVisible() {
      return window.innerWidth < 1024 ? 3 : 6;
    }

    // Show/hide reviews based on expanded state
    function updateReviews() {
      const defaultVisible = getDefaultVisible();
      reviewBlocks.forEach((block, index) => {
        block.style.display = expanded || index < defaultVisible ? "block" : "none";
      });

      const btnText = toggleButton?.querySelector("span");
      if (btnText) {
        btnText.textContent = expanded ? "Show less" : "Show more";
      }
      toggleButton?.classList.toggle("expanded", expanded);
    }

    // Init
    updateReviews();

    // Toggle button click
    toggleButton?.addEventListener("click", function () {
      expanded = !expanded;
      updateReviews();
    });

    // Recalculate on window resize
    window.addEventListener("resize", function () {
      if (!expanded) {
        updateReviews();
      }
    });
  });
</script>


{% schema %}
{
  "name": "Reviews Grid",
  "tag": "section",
  "class": "review-area-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "reviews"
    },
    {
      "type": "text",
      "id": "average_rating",
      "label": "Average Rating",
      "default": "4.8",
      "info": "Maximum value is 5"
    },
    {
      "type": "number",
      "id": "full_stared_rating",
      "label": "Full Star Rating Count",
      "default": 4
    },
    {
      "type": "number",
      "id": "half_started_rating",
      "label": "Half Star Rating Count",
      "default": 0,
      "info": "Max: 1"
    },
    {
      "type": "text",
      "id": "review_count_text",
      "label": "Review Count Text",
      "default": "Based on 138 reviews"
    },
    {
      "type": "checkbox",
      "id": "show_more_enabled",
      "label": "Enable Show More Button",
      "default": true
    },
    {
      "type": "text",
      "id": "show_more_label",
      "label": "Label for Show More Button",
      "default": "show more"
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Customer Review",
      "settings": [
        {
          "type": "text",
          "id": "reviewer_name",
          "label": "Reviewer Name",
          "default": "Chris J."
        },
        {
          "type": "text",
          "id": "buyer_type",
          "label": "Buyer Type",
          "default": "Verified buyer"
        },
        {
          "type": "checkbox",
          "id": "show_verified_icon",
          "label": "Show Verified Icon",
          "default": true
        },
        {
          "type": "number",
          "id": "rating",
          "label": "Rating",
          "default": 4,
          "info": "Maximum value is 5"
        },
        {
          "type": "text",
          "id": "review_title",
          "label": "Review Title",
          "default": "Works amazing"
        },
        {
          "type": "textarea",
          "id": "review_text",
          "label": "Review Text",
          "default": "Been using Alpha Skin for a few weeks now..."
        },
        {
          "type": "image_picker",
          "id": "profile_image",
          "label": "Profile Image"
        },
        {
          "type": "number",
          "id": "reaction_count",
          "label": "Reaction Count",
          "default": 132
        },
        {
          "type": "text",
          "id": "review_date",
          "label": "Review Date (e.g. “1 year ago”)",
          "default": "1 year ago"
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Reviews Grid",
      "category": "Custom",
      "blocks": [
        {
          "type": "review"
        },
        {
          "type": "review"
        },
        {
          "type": "review"
        },
        {
          "type": "review"
        },
        {
          "type": "review"
        },
        {
          "type": "review"
        }
      ]
    }
  ]
}
{% endschema %}
