<div class="announcement-bar header-top-bar">
  <div class="container-max">
    <div class="header-top-bar-inner">
      <div>
        <p class="font-small">{{ section.settings.announcement_text }}</p>
         <p class="font-small" style=" margin-top: 4px; font-family: Swiss721BT-Light">{{ section.settings.announcement_additional_text }}</p>
      </div>
      <div>
        {% comment %} <p class="font-small">{{ section.settings.announcement_additional_text }}</p> {% endcomment %}
         <style>
  .timer-wrapper {
    display: flex;
    gap: 2px;
    font-family: 'Swiss721BT-Medium', Arial, sans-serif;
  }

  .timer-box {
    background: #ffffff10; /* subtle white tint on black */
    border: 1px solid #ffffff40;
    color: #ffffff;
    font-size: 12px;
    padding: 4px 6px;
    border-radius: 1px;
    text-align: center;
    min-width: 24px;
  }
</style>
<div class="timer-wrapper">
  <div id="days" class="timer-box">00d</div>
  <div id="hours" class="timer-box">00h</div>
  <div id="minutes" class="timer-box">00m</div>
  <div id="seconds" class="timer-box">00s</div>
</div>

 <script>
    function getNextMidnightGMTMinus5() {
      // Get current time in GMT-5
      const now = new Date();
      const gmtMinus5 = new Date(now.toLocaleString('en-US', { timeZone: 'America/New_York' }));
      
      // Set to next midnight (start of next day)
      const nextMidnight = new Date(gmtMinus5);
      nextMidnight.setHours(24, 0, 0, 0);
      
      return nextMidnight.getTime();
    }

    function updateTimer() {
      const now = new Date();
      const gmtMinus5Now = new Date(now.toLocaleString('en-US', { timeZone: 'America/New_York' }));
      const targetTime = getNextMidnightGMTMinus5();
      
      const difference = targetTime - gmtMinus5Now.getTime();

      if (difference <= 0) {
        // Timer reached zero, restart from 23:59:59
        updateTimer();
        return;
      }

      const days = Math.floor(difference / (1000 * 60 * 60 * 24));
      const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((difference % (1000 * 60)) / 1000);

      document.getElementById('days').textContent = String(days).padStart(2, '0') + 'd';
      document.getElementById('hours').textContent = String(hours).padStart(2, '0') + 'h';
      document.getElementById('minutes').textContent = String(minutes).padStart(2, '0') + 'm';
      document.getElementById('seconds').textContent = String(seconds).padStart(2, '0') + 's';
    }

    // Update every second
    updateTimer();
    setInterval(updateTimer, 1000);
  </script>




{% comment %} 
 <div class="timer-wrapper">
  <div id="days" class="timer-box">00d</div>
  <div id="hours" class="timer-box">00h</div>
  <div id="minutes" class="timer-box">00m</div>
  <div id="seconds" class="timer-box">00s</div>
</div> 

 <script>
  const deadline = new Date("2026-02-04T23:59:59-05:00").getTime();

  function updateTimer() {
    const now = new Date().getTime();
    const t = deadline - now;

    if (t <= 0) {
      document.getElementById("days") && (document.getElementById("days").innerHTML = "00d");
      document.getElementById("hours") && (document.getElementById("hours").innerHTML = "00h");
      document.getElementById("minutes") && (document.getElementById("minutes").innerHTML = "00m");
      document.getElementById("seconds") && (document.getElementById("seconds").innerHTML = "00s");
      return;
    }

    const days = Math.floor(t / (1000 * 60 * 60 * 24));
    const hours = Math.floor((t % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((t % (1000 * 60)) / 1000);

    document.getElementById("days") && (document.getElementById("days").innerHTML =
      (days < 10 ? "0" + days : days) + "d");
    document.getElementById("hours") && (document.getElementById("hours").innerHTML =
      (hours < 10 ? "0" + hours : hours) + "h");
    document.getElementById("minutes") && (document.getElementById("minutes").innerHTML =
      (minutes < 10 ? "0" + minutes : minutes) + "m");
    document.getElementById("seconds") && (document.getElementById("seconds").innerHTML =
      (seconds < 10 ? "0" + seconds : seconds) + "s");
  }

  updateTimer();
  setInterval(updateTimer, 1000);
</script>  {% endcomment %}

{% comment %} <script>
  // Local deadline for every user — 28 Nov 2025 at 23:59 in THEIR timezone
  const deadline = new Date("2025-11-28T23:59:00").getTime();

  function updateTimer() {
    const now = new Date().getTime();
    const t = deadline - now;

    if (t <= 0) {
      document.getElementById("days").innerHTML = "00d";
      document.getElementById("hours").innerHTML = "00h";
      document.getElementById("minutes").innerHTML = "00m";
      document.getElementById("seconds").innerHTML = "00s";
      return;
    }

    const days = Math.floor(t / (1000 * 60 * 60 * 24));
    const hours = Math.floor((t % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((t % (1000 * 60)) / 1000);

    document.getElementById("days").innerHTML = (days < 10 ? "0" + days : days) + "d";
    document.getElementById("hours").innerHTML = (hours < 10 ? "0" + hours : hours) + "h";
    document.getElementById("minutes").innerHTML = (minutes < 10 ? "0" + minutes : minutes) + "m";
    document.getElementById("seconds").innerHTML = (seconds < 10 ? "0" + seconds : seconds) + "s";
  }

  updateTimer();
  setInterval(updateTimer, 1000);
</script> {% endcomment %}


      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Set the height of the announcement bar dynamically
    document.documentElement.style.setProperty(
      '--announcement-bar-height', 
      `${document.getElementById('shopify-section-{{ section.id }}').clientHeight.toFixed(2)}px`
    );
  });
</script>

{% schema %}
  {
    "name": "New Announcement Bar",
    "class": "announcement-bar",
    "tag": "section",
    "settings": [
      {
        "type": "text",
        "id": "announcement_text",
        "label": "Announcement Text",
        "default": "Free shipping over €50 euro’s"
      },
      {
        "type": "text",
        "id": "announcement_additional_text",
        "label": "Additional Announcement Text",
        "default": "+"
      }
    ],
    "presets": [
      {
        "name": "New Announcement Bar",
        "category": "Header"
      }
    ]
  }
{% endschema %}
