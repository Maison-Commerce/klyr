

<div 
  class="menu-tabs product-tabs"
  id="product-tabs-{{ section.id }}-{{ block.id }}"
  {{ block.shopify_attributes }}
>
  <div class="inner-container">
    <div class="inner-row">
      <div class="product-tabs__container">
        <ul class="product-tabs__menu">
          {% if block.settings.tab1_title != blank %}
            <li class="tab-link active" data-tab="tab1"><span>{{ block.settings.tab1_title }}</span></li>
          {% endif %}
          {% if block.settings.tab2_title != blank %}
            <li class="tab-link{% if block.settings.tab1_title == blank %} active{% endif %}" data-tab="tab2">
              <span>{{ block.settings.tab2_title }}</span>
            </li>
          {% endif %}
          {% if block.settings.tab3_title != blank %}
            <li class="tab-link" data-tab="tab3"><span>{{ block.settings.tab3_title }}</span></li>
          {% endif %}
          {% if block.settings.tab4_title != blank %}
            <li class="tab-link" data-tab="tab4"><span>{{ block.settings.tab4_title }}</span></li>
          {% endif %}
          {% if block.settings.tab5_title != blank %}
            <li class="tab-link" data-tab="tab5"><span>{{ block.settings.tab5_title }}</span></li>
          {% endif %}
          {% if block.settings.tab6_title != blank %}
            <li class="tab-link" data-tab="tab6"><span>{{ block.settings.tab6_title }}</span></li>
          {% endif %}
        </ul>
        <!-- Tab 01 -->
        {% if block.settings.tab1_title != blank %}
          <div id="tab1" class="tab-content product-description active">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab1_content }}
              </div>
              <button class="toggle-btn">
                <span class="label">{{ 'actions.show_more' | t }}</span>
                <span class="arrow">
                  <svg class="arrow-icon" width="13" height="7" viewBox="0 0 13 7" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <rect width="8.48545" height="1.06068"
                      transform="matrix(-0.707106 0.707108 -0.707106 -0.707108 12.5 0.750061)" fill="#231C19" />
                    <rect width="8.48545" height="1.06068"
                      transform="matrix(0.707106 0.707108 -0.707106 0.707108 1.25 0.00012207)" fill="#231C19" />
                  </svg>
                </span>
              </button>
            </div>
          </div>
        {% endif %}
        <!-- Tab 02 -->
        {% if block.settings.tab2_title != blank %}
          <div id="tab2" class="tab-content{% if block.settings.tab1_title == blank %} active{% endif %}">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab2_content }}
              </div>
            </div>
          </div>
        {% endif %}
        <!-- Tab 03 -->
        {% if block.settings.tab3_title != blank %}
          <div id="tab3" class="tab-content">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab3_content }}
              </div>
            </div>
          </div>
        {% endif %}
        <!-- Tab 04 -->
        {% if block.settings.tab4_title != blank %}
          <div id="tab4" class="tab-content">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab4_content }}
              </div>
            </div>
          </div>
        {% endif %}
        <!-- Tab 05 -->
        {% if block.settings.tab5_title != blank %}
          <div id="tab5" class="tab-content">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab5_content }}
              </div>
            </div>
          </div>
        {% endif %}
        <!-- Tab 06 -->
        {% if block.settings.tab6_title != blank %}
          <div id="tab6" class="tab-content">
            <div class="tab-inner">
              <div class="tab-description">
                {{ block.settings.tab6_content }}
              </div>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
  /**
  * Sets the width of the tab container and individual tab spans.
  * This function is intended for mobile views (< 768px).
  */
  function setTabsWidth() {
    // Select the necessary elements
    const headerColumns = document.querySelector('.header__columns');
    const tabWrapper = document.querySelector('.product-tabs__container');
    const tabLinks = document.querySelectorAll(".product-tabs__menu .tab-link");

    // Exit if critical elements aren't found
    if (!headerColumns || !tabWrapper) {
      console.warn("Tab width elements not found.");
      return;
    }

    // Set the width of the main tab container
    const headerWidth = headerColumns.getBoundingClientRect().width + 32;
    tabWrapper.style.width = `${headerWidth}px`;
    
    // Set the width for each tab's inner span
    tabLinks.forEach(function (tab) {
      const span = tab.querySelector('span');
      if (span) {
        const width = tab.getBoundingClientRect().width + 16;
        span.style.width = `${width}px`;
      }
    });
  }

  /**
  * Resets the inline widths, allowing CSS to take control.
  * This function is for desktop views (>= 768px).
  */
  function resetTabsWidth() {
    const tabWrapper = document.querySelector('.product-tabs__container');
    const tabLinks = document.querySelectorAll(".product-tabs__menu .tab-link");

    if (tabWrapper) {
      tabWrapper.style.width = ''; // Remove inline style
    }

    tabLinks.forEach(function (tab) {
      const span = tab.querySelector('span');
      if (span) {
        span.style.width = ''; // Remove inline style
      }
    });
  }

  // --------------------------------------------------
  // Main Execution Logic
  // --------------------------------------------------

  // 1. Define the media query for screens less than 575px
  const mediaQuery = window.matchMedia('(max-width: 574.98px)');

  /**
  * Handles the screen size change by calling the appropriate function.
  * @param {MediaQueryListEvent} e The media query event.
  */
  function handleScreenChange(e) {
    if (e.matches) {
      // Screen is LESS than 768px wide
      setTabsWidth();
    } else {
      // Screen is 768px or WIDER
      resetTabsWidth();
    }
  }

  // 2. Listen for changes in the viewport size
  mediaQuery.addEventListener('change', handleScreenChange);
  window.addEventListener("resize", handleScreenChange(mediaQuery));

  // 3. Run the check once on initial page load to set the correct state
  handleScreenChange(mediaQuery);
</script>

{% schema %}
{
  "name": "Product Tabs",
  "tag": null,
  "settings": [
    {
      "type": "text",
      "id": "tab1_title",
      "label": "Tab 1 Title",
      "default": "Details"
    },
    {
      "type": "liquid",
      "id": "tab1_content",
      "label": "Tab 1 Content",
      "default": "<p>Made in Nijmegen, the Netherlands — where precision grooming meets European craftsmanship. Designed for men, our products combine clean formulas.</p>"
    },
    {
      "type": "text",
      "id": "tab2_title",
      "label": "Tab 2 Title",
      "default": "How to use"
    },
    {
      "type": "liquid",
      "id": "tab2_content",
      "label": "Tab 2 Content",
      "default": "<p>Our products combine clean Made in Nijmegen, the Netherlands — where precision grooming meets European craftsmanship.</p>"
    },
    {
      "type": "text",
      "id": "tab3_title",
      "label": "Tab 3 Title",
      "default": "Shipping & returns"
    },
    {
      "type": "liquid",
      "id": "tab3_content",
      "label": "Tab 3 Content",
      "default": "<p>Where precision grooming meets European craftsmanship. Designed for men, our products combine clean formulas.</p>"
    },
    {
      "type": "text",
      "id": "tab4_title",
      "label": "Tab 4 Title",
      "default": "Ingrediënts"
    },
    {
      "type": "liquid",
      "id": "tab4_content",
      "label": "Tab 4 Content",
      "default": "<p>Results you can trust., the Netherlands — where precision grooming meets European craftsmanship.</p>"
    },
    {
      "type": "text",
      "id": "tab5_title",
      "label": "Tab 5 Title"
    },
    {
      "type": "liquid",
      "id": "tab5_content",
      "label": "Tab 5 Content"
    },
    {
      "type": "text",
      "id": "tab6_title",
      "label": "Tab 6 Title"
    },
    {
      "type": "liquid",
      "id": "tab6_content",
      "label": "Tab 6 Content"
    }
  ],
  "presets": [
    {
      "name": "Product Tabs"
    }
  ]
}
{% endschema %}
